<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    <title>IT Help Desk</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://alcdn.msauth.net/browser/2.14.2/js/msal-browser.min.js"></script>
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "pf2n4ml50a");
    </script>
</head>
<body>
    <div id="header-placeholder"></div>

    <div class="scrolling-message" id="marquee-placeholder"></div>

    <main id="main-content">
        <div class="banner"></div>
        <div class="button-container">
            <a href="https://forms.office.com/r/xunK5Cj8cf" class="button" aria-label="Main IT Form" target="_blank" rel="noopener">
                <img src="images/mainit1.png" alt="Main IT Form">
            </a>
            <a href="https://forms.office.com/r/E4v0tWrq0f" class="button" aria-label="LP Ticket Form" target="_blank" rel="noopener">
                <img src="images/LPticket1.png" alt="LP Ticket Form">
            </a>
            <a href="https://forms.office.com/r/1tJ7vWxRtu" class="button" aria-label="SF Ticket Form" target="_blank" rel="noopener">
                <img src="images/SFticket1.png" alt="SF Ticket Form">
            </a>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <script src="loadHeaderFooter.js"></script>
    <script>
        const msalConfig = {
            auth: {
                clientId: '4bbc56d1-764a-4852-8e0a-f5f8d1aebd6a',
                authority: 'https://login.microsoftonline.com/bcb6fc16-659f-41d3-98c9-5c276e196944',
                redirectUri: '/helpdesk/home.html'
            }
        };

        const msalInstance = new msal.PublicClientApplication(msalConfig);
        const account = JSON.parse(sessionStorage.getItem('msalAccount'));

        if (account) {
            msalInstance.acquireTokenSilent({
                account: account,
                scopes: ["user.read"]
            }).then(tokenResponse => {
                console.log('Token acquired silently:', tokenResponse);
            }).catch(error => {
                console.error('Error acquiring token silently:', error);
            });
        }

        loadHTML('marquee.html', 'marquee-placeholder').then(() => {
            const marqueeText = document.getElementById('marquee-text');
            const marqueeContent = marqueeText.textContent;

            if (marqueeContent.startsWith('[!]')) {
                marqueeText.textContent = marqueeContent.substring(3);
                marqueeText.parentElement.style.backgroundColor = 'red';
            } else if (marqueeContent.startsWith('[c]')) {
                marqueeText.textContent = marqueeContent.substring(3);
                marqueeText.parentElement.style.backgroundColor = 'yellow';
                marqueeText.style.color = 'black';
            } else {
                marqueeText.parentElement.style.backgroundColor = '#1187d9';
                marqueeText.style.color = 'white';
            }
        });
    </script>
</body>
</html>